### Документация: Установка и использование `network-scanner`

---

#### **1. Описание проекта**
Разработана утилита `network-scanner`, которая сканирует доступные IP-адреса в указанной подсети. Утилита написана на языке Go и упакована в `.deb`-пакет. Пакет доступен через собственный APT-репозиторий, который мы развернут на виртуальной машине Google Cloud. Особенность утилиты заключается в ее оптимизации: она основана на горутинах и может быстро и эффективно сканнить даже подсеть с большим количеством хостов.

---

#### **2. Шаги выполнения**
##### **2.1. Создание виртуальной машины в Google Cloud**
1. Написан Go-скрипт для автоматического создания виртуальной машины в Google Cloud. Скрипт:
   - Создаёт VM на базе образа Ubuntu 24.04.
   - Добавляет SSH-ключ для доступа.
   - Настраивает брандмауэр для открытия порта `80` для HTTP.

2. **Код запуска виртуальной машины**:
   - Расположен в файле [`startup.go`](./startup.go).
   - Включает автоматическую генерацию Ansible [`inventory`](./ansible/inventory) файла и запуск Ansible Playbook для настройки VM.

##### **2.2. Разработка Ansible Playbook**
- [Ansible Playbook](./ansible/playbook.yml) настроен для автоматизации следующих шагов:
  - Установка необходимых зависимостей (Go, dpkg-dev, nginx и т. д.).
  - Копирование исходного кода `network-scanner` на сервер и его сборка.
  - Упаковка утилиты в `.deb`-пакет.
  - Настройка APT-репозитория

---

#### **3. Установка и использование `network-scanner`**

##### **3.1. Добавление репозитория**
1. На клиентской машине выполните команду:
   ```bash
   echo "deb [trusted=yes] http://35.228.254.182/ ./" | sudo tee /etc/apt/sources.list.d/network-scanner.list
   ```

2. Обновите список пакетов:
   ```bash
   sudo apt update
   ```

##### **3.2. Установка `network-scanner`**
1. Установите пакет:
   ```bash
   sudo apt install network-scanner
   ```

2. Убедитесь, что утилита установлена:
   ```bash
   which network-scanner
   ```

##### **3.3. Использование `network-scanner`**
1. Для запуска выполните:
   ```bash
   network-scanner <subnet>
   ```
   Например:
   ```bash
   network-scanner 192.168.1.0/24
   ```

2. Пример вывода:
   ```
   Accessible IPs:
   192.168.1.1
   192.168.1.15
   ```

---

#### **4. Удаление `network-scanner`**
1. Для удаления пакета выполните:
   ```bash
   sudo apt remove network-scanner
   ```

2. Удалите APT-репозиторий:
   ```bash
   sudo rm /etc/apt/sources.list.d/network-scanner.list
   sudo apt update
   ```

---

#### **6. Примечания**
- Репозиторий создаётся с использованием `dpkg-scanpackages`.
- Для тестирования APT-репозитория используется `curl` c выводом содержимого `control`'а:
  ```bash
  curl http://35.228.254.182/Packages.gz | gunzip -c
  ```

- Все команды тестировались на Ubuntu 24.04.

---
